Description: Upstream changes introduced in version 2.0.0~svn2979-3
 This patch has been created by dpkg-source during the package build.
 Here's the last changelog entry, hopefully it gives details on why
 those changes were made:
 .
 mapnik2 (2.0.0~svn2979-3) unstable; urgency=low
 .
   * Remove mapnik-config from mapnik2-utils package
 .
 The person named in the Author field signed this changelog entry.
Author: Anthony Prades <anthony.prades@makina-corpus.com>

---
The information above should follow the Patch Tagging Guidelines, please
checkout http://dep.debian.net/deps/dep3/ to learn about the format. Here
are templates for supplementary fields that you might want to add:

Origin: <vendor|upstream|other>, <url of original patch>
Bug: <url in upstream bugtracker>
Bug-Debian: http://bugs.debian.org/<bugnumber>
Bug-Ubuntu: https://launchpad.net/bugs/<bugnumber>
Forwarded: <no|not-needed|url proving that it has been forwarded>
Reviewed-By: <name and email of someone who approved the patch>
Last-Update: <YYYY-MM-DD>

--- /dev/null
+++ mapnik2-2.0.0~svn2979/demo/viewer/viewer.ini
@@ -0,0 +1,5 @@
+
+[mapnik]
+plugins_dir=/usr/local/lib/mapnik2/input
+fonts/1/dir=/usr/local/lib/mapnik2/fonts
+fonts/size=1
--- /dev/null
+++ mapnik2-2.0.0~svn2979/utils/mapnik-config/mapnik2.pc
@@ -0,0 +1,22 @@
+#!/bin/sh
+
+prefix=/usr/local
+exec_prefix=${prefix}
+includedir=${prefix}/include
+libdir=${exec_prefix}/lib
+version='2.0.0'
+mapnik_libname=mapnik2
+private_libs=' -lfreetype -licuuc -lboost_filesystem -lboost_regex -lcairomm-1.0 -lcairo -lxml2 -lboost_thread -lboost_system'
+other_libs=' -L/usr/local/lib -L/usr/lib -lfreetype -licuuc -lboost_filesystem -lboost_regex -lcairomm-1.0 -lcairo -lxml2 -lboost_thread -lboost_system'
+other_includes='-DHAVE_JPEG -DBOOST_REGEX_HAS_ICU -ansi -Wall -pthread -ftemplate-depth-200 -DLINUX -DBOOST_SPIRIT_THREADSAFE -DMAPNIK_THREADSAFE -O3 -finline-functions -Wno-inline -DNDEBUG -I/usr/local/include -I/usr/include/ -I/usr/include/freetype2 -I/usr/include/libxml2 -I/usr/include/gdal -I/usr/include/postgresql -DHAVE_CAIRO -DLIBTOOL_SUPPORTS_ADVISE'
+fonts='/usr/local/lib/mapnik2/fonts'
+input_plugins='/usr/local/lib/mapnik2/input'
+svn_revision='None'
+
+Name: libmapnik
+Version: ${version}
+Description: libmapnik library.
+Requires:
+Libs: -L${libdir} -l${mapnik_libname}
+Libs.private: ${private_libs} 
+Cflags: -I${includedir}
--- /dev/null
+++ mapnik2-2.0.0~svn2979/utils/mapnik-config/mapnik-config
@@ -0,0 +1,112 @@
+#!/bin/sh
+
+prefix=/usr/local
+exec_prefix=${prefix}
+includedir=${prefix}/include
+libdir=${exec_prefix}/lib
+version='2.0.0'
+mapnik_libname=mapnik2
+private_libs=' -lfreetype -licuuc -lboost_filesystem -lboost_regex -lcairomm-1.0 -lcairo -lxml2 -lboost_thread -lboost_system'
+other_libs=' -L/usr/local/lib -L/usr/lib -lfreetype -licuuc -lboost_filesystem -lboost_regex -lcairomm-1.0 -lcairo -lxml2 -lboost_thread -lboost_system'
+other_includes='-DHAVE_JPEG -DBOOST_REGEX_HAS_ICU -ansi -Wall -pthread -ftemplate-depth-200 -DLINUX -DBOOST_SPIRIT_THREADSAFE -DMAPNIK_THREADSAFE -O3 -finline-functions -Wno-inline -DNDEBUG -I/usr/local/include -I/usr/include/ -I/usr/include/freetype2 -I/usr/include/libxml2 -I/usr/include/gdal -I/usr/include/postgresql -DHAVE_CAIRO -DLIBTOOL_SUPPORTS_ADVISE'
+fonts='/usr/local/lib/mapnik2/fonts'
+input_plugins='/usr/local/lib/mapnik2/input'
+svn_revision='None'
+usage()
+{
+    cat <<EOF
+Usage: mapnik-config [OPTION]
+
+Known values for OPTION are:
+
+  --prefix          display mapnik prefix [default $prefix]
+  --prefix=DIR      change mapnik prefix [default $prefix]
+  --exec-prefix=DIR change mapnik exec prefix [default $exec_prefix]
+  --libs            print library linking information
+  --cflags          print pre-processor and compiler flags
+  --fonts           print default fonts directory
+  --input-plugins   print default input plugins directory
+  --help            display this help and exit
+  -v --version      output version information
+  --svn-revision    output svn revision information
+EOF
+
+    exit $1
+}
+
+if test $# -eq 0; then
+    usage 1
+fi
+
+cflags=false
+libs=false
+
+while test $# -gt 0; do
+    case "$1" in
+    -*=*) optarg=`echo "$1" | sed 's/[-_a-zA-Z0-9]*=//'` ;;
+    *) optarg= ;;
+    esac
+
+    case "$1" in
+    
+    --prefix=*)
+      prefix=$optarg
+      includedir=$prefix/include
+      libdir=$prefix/lib
+      ;;
+
+    --prefix)
+      echo $prefix
+      ;;
+
+    --exec-prefix=*)
+      exec_prefix=$optarg
+      libdir=$exec_prefix/lib
+      ;;
+
+    --exec-prefix)
+      echo $exec_prefix
+      ;;
+
+    -v)
+      echo $version
+      ;;
+
+    --version)
+      echo $version
+      ;;
+
+    --svn-revision)
+      echo ${svn_revision}
+      ;;
+
+    --help)
+      usage 0
+      ;;
+
+    --fonts)
+      echo ${fonts} 
+      ;;
+
+    --input-plugins)
+      echo ${input_plugins} 
+      ;;
+      
+    --cflags)
+      echo -I${includedir} ${other_includes}
+      ;;
+
+    --libs)
+      echo -L${libdir} -l${mapnik_libname} ${other_libs}
+      ;;
+
+    *)
+  # if no matches, return 'usage 1' meaning usage + 1 (error return type)
+  usage 1
+  exit 1
+  ;;
+    esac
+    shift
+done
+
+exit 0
--- mapnik2-2.0.0~svn2979.orig/CHANGELOG
+++ mapnik2-2.0.0~svn2979/CHANGELOG
@@ -14,6 +14,10 @@ For a complete change history, see the S
 Mapnik Trunk
 ------------
 
+- Fixed quoting syntax for "table"."attribute" in PostGIS plugin (previously if table aliases were used quoting like "table.attribute" would cause query failure) (r2979).
+
+- Added the ability to control the PostGIS feature id by suppling a key_field to reference and integer attribute name (r2979).
+
 - Added alternative, more robust proj_transform functions to project a bbox using more points than just the four
   corners to ensure an optimally sized bbox despite proj4 out of bounds conditions. (olt)
 
--- mapnik2-2.0.0~svn2979.orig/INSTALL
+++ mapnik2-2.0.0~svn2979/INSTALL
@@ -1,4 +1,4 @@
-# $Id: INSTALL 2888 2011-05-10 15:57:45Z dane $
+# $Id$
 
 INSTALLATION INSTRUCTIONS
 
--- mapnik2-2.0.0~svn2979.orig/SConstruct
+++ mapnik2-2.0.0~svn2979/SConstruct
@@ -16,7 +16,7 @@
 # License along with this library; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 #
-# $Id: SConstruct 2976 2011-06-13 15:20:29Z dane $
+# $Id$
 
 
 import os
--- mapnik2-2.0.0~svn2979.orig/bindings/python/mapnik/ogcserver/WMS.py
+++ mapnik2-2.0.0~svn2979/bindings/python/mapnik/ogcserver/WMS.py
@@ -17,7 +17,7 @@
 # License along with this library; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 #
-# $Id: WMS.py 1782 2010-05-08 17:07:03Z dane $
+# $Id$
 
 """Interface for registering map styles and layers for availability in WMS Requests."""
 
--- mapnik2-2.0.0~svn2979.orig/bindings/python/mapnik/ogcserver/__init__.py
+++ mapnik2-2.0.0~svn2979/bindings/python/mapnik/ogcserver/__init__.py
@@ -17,7 +17,7 @@
 # License along with this library; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 #
-# $Id: __init__.py 2796 2011-04-19 00:20:50Z dane $
+# $Id$
 
 """Mapnik OGC WMS Server."""
 
--- mapnik2-2.0.0~svn2979.orig/bindings/python/mapnik/ogcserver/cgiserver.py
+++ mapnik2-2.0.0~svn2979/bindings/python/mapnik/ogcserver/cgiserver.py
@@ -17,7 +17,7 @@
 # License along with this library; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 #
-# $Id: cgiserver.py 2326 2010-11-08 23:18:08Z dane $
+# $Id$
 
 """CGI/FastCGI handler for Mapnik OGC WMS Server.
 
--- mapnik2-2.0.0~svn2979.orig/bindings/python/mapnik/ogcserver/common.py
+++ mapnik2-2.0.0~svn2979/bindings/python/mapnik/ogcserver/common.py
@@ -17,7 +17,7 @@
 # License along with this library; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 #
-# $Id: common.py 1782 2010-05-08 17:07:03Z dane $
+# $Id$
 
 """Core OGCServer classes and functions."""
 
--- mapnik2-2.0.0~svn2979.orig/bindings/python/mapnik/ogcserver/configparser.py
+++ mapnik2-2.0.0~svn2979/bindings/python/mapnik/ogcserver/configparser.py
@@ -17,7 +17,7 @@
 # License along with this library; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 #
-# $Id: configparser.py 897 2009-02-12 01:11:18Z dane $
+# $Id$
 
 """ Change SafeConfigParser behavior to treat options without values as
     non-existent.
--- mapnik2-2.0.0~svn2979.orig/bindings/python/mapnik/ogcserver/exceptions.py
+++ mapnik2-2.0.0~svn2979/bindings/python/mapnik/ogcserver/exceptions.py
@@ -17,7 +17,7 @@
 # License along with this library; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 #
-# $Id: exceptions.py 1033 2009-03-30 04:25:01Z dane $
+# $Id$
 
 """Custom OGCServer Exceptions"""
 
--- mapnik2-2.0.0~svn2979.orig/bindings/python/mapnik/ogcserver/wms111.py
+++ mapnik2-2.0.0~svn2979/bindings/python/mapnik/ogcserver/wms111.py
@@ -17,7 +17,7 @@
 # License along with this library; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 #
-# $Id: wms111.py 1782 2010-05-08 17:07:03Z dane $
+# $Id$
 
 """WMS 1.1.1 compliant GetCapabilities, GetMap, GetFeatureInfo, and Exceptions interface."""
 
--- mapnik2-2.0.0~svn2979.orig/bindings/python/mapnik/ogcserver/wms130.py
+++ mapnik2-2.0.0~svn2979/bindings/python/mapnik/ogcserver/wms130.py
@@ -17,7 +17,7 @@
 # License along with this library; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 #
-# $Id: wms130.py 1782 2010-05-08 17:07:03Z dane $
+# $Id$
 
 """WMS 1.3.0 compliant GetCapabilities, GetMap, GetFeatureInfo, and Exceptions interface."""
 
--- mapnik2-2.0.0~svn2979.orig/bindings/python/mapnik/ogcserver/wsgi.py
+++ mapnik2-2.0.0~svn2979/bindings/python/mapnik/ogcserver/wsgi.py
@@ -17,7 +17,7 @@
 # License along with this library; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 #
-# $Id: wsgi.py 2326 2010-11-08 23:18:08Z dane $
+# $Id$
 
 """WSGI application wrapper for Mapnik OGC WMS Server."""
 
--- mapnik2-2.0.0~svn2979.orig/demo/python/README.txt
+++ mapnik2-2.0.0~svn2979/demo/python/README.txt
@@ -1,4 +1,4 @@
-# $Id: README.txt 189 2006-03-22 02:41:13Z jdoyon $
+# $Id$
 
 This directory contains a sample python script implementing the Mapnik API.
 
--- mapnik2-2.0.0~svn2979.orig/demo/python/rundemo.py
+++ mapnik2-2.0.0~svn2979/demo/python/rundemo.py
@@ -1,7 +1,7 @@
 #!/usr/bin/env python
 # -*- coding: utf-8 -*-
 #
-# $Id: rundemo.py 2300 2010-11-03 13:18:56Z artem $
+# $Id$
 #
 # This file is part of Mapnik (c++ mapping toolkit)
 # Copyright (C) 2005 Jean-Francois Doyon
--- mapnik2-2.0.0~svn2979.orig/docs/ogcserver/readme.txt
+++ mapnik2-2.0.0~svn2979/docs/ogcserver/readme.txt
@@ -1,4 +1,4 @@
-# $Id: readme.txt 2324 2010-11-08 21:37:16Z dane $
+# $Id$
 
 Mapnik OGC Server
 -----------------
--- mapnik2-2.0.0~svn2979.orig/src/grid/grid_renderer.cpp
+++ mapnik2-2.0.0~svn2979/src/grid/grid_renderer.cpp
@@ -62,7 +62,7 @@ grid_renderer<T>::grid_renderer(Map cons
       width_(pixmap_.width()),
       height_(pixmap_.height()),
       scale_factor_(scale_factor),
-      t_(pixmap_.width(),pixmap_.width(),m.get_current_extent(),offset_x,offset_y),
+      t_(pixmap_.width(),pixmap_.height(),m.get_current_extent(),offset_x,offset_y),
       font_engine_(),
       font_manager_(font_engine_),
       detector_(box2d<double>(-m.buffer_size(), -m.buffer_size(), pixmap_.width() + m.buffer_size(), pixmap_.height() + m.buffer_size())),
--- mapnik2-2.0.0~svn2979.orig/tests/python_tests/feature_id_test.py
+++ mapnik2-2.0.0~svn2979/tests/python_tests/feature_id_test.py
@@ -43,8 +43,6 @@ def test_shapefile_polygon_featureset_id
     compare_shape_between_mapnik_and_ogr('../data/shp/poly.shp')
 
 def test_shapefile_polygon_feature_query_id():
-    # results in different results between shp and ogr!
-    #bbox = (-14284551.8434, 2074195.1992, -7474929.8687, 8140237.7628)
     bbox = (15523428.2632, 4110477.6323, -11218494.8310, 7495720.7404)
     query = mapnik2.Query(mapnik2.Box2d(*bbox))
     ds = mapnik2.Ogr(file='../data/shp/world_merc.shp',layer_by_index=0)
@@ -52,10 +50,22 @@ def test_shapefile_polygon_feature_query
         query.add_property_name(fld)
     compare_shape_between_mapnik_and_ogr('../data/shp/world_merc.shp',query)
 
-
+def test_feature_hit_count():
+    # results in different results between shp and ogr!
+    #bbox = (-14284551.8434, 2074195.1992, -7474929.8687, 8140237.7628)
+    bbox = (1113194.91,4512803.085,2226389.82,6739192.905)
+    query = mapnik2.Query(mapnik2.Box2d(*bbox))
+    ds1 = mapnik2.Ogr(file='../data/shp/world_merc.shp',layer_by_index=0)
+    for fld in ds1.fields():
+        query.add_property_name(fld)
+    ds2 = mapnik2.Shapefile(file='../data/shp/world_merc.shp')
+    count1 = len(ds1.features(query).features)
+    count2 = len(ds2.features(query).features)
+    eq_(count1,count2,"Feature count differs between OGR driver (%s features) and Shapefile Driver (%s features) when querying the same bbox" % (count1,count2))
 
 if __name__ == "__main__":
     setup()
     test_shapefile_line_featureset_id()
     test_shapefile_polygon_featureset_id()
-    test_shapefile_polygon_feature_query_id()
\ No newline at end of file
+    test_shapefile_polygon_feature_query_id()
+    test_feature_hit_count()
\ No newline at end of file
--- /dev/null
+++ mapnik2-2.0.0~svn2979/tests/python_tests/render_grid_test.py
@@ -0,0 +1,147 @@
+#!/usr/bin/env python
+# -*- coding: utf-8 -*-
+
+from nose.tools import *
+
+import os, mapnik2
+from utilities import Todo
+import json
+
+
+grid_correct = {"keys": ["", "North West", "North East", "South West", "South East"], "data": {"South East": {"Name": "South East"}, "North East": {"Name": "North East"}, "North West": {"Name": "North West"}, "South West": {"Name": "South West"}}, "grid": ["                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "         !!!                                 ###                ", "        !!!!!                               #####               ", "        !!!!!                               #####               ", "         !!!                                 ###                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "        $$$$                                %%%%                ", "        $$$$$                               %%%%%               ", "        $$$$$                               %%%%%               ", "         $$$                                 %%%                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                "]}
+
+
+grid_correct_new = {"keys": ["", "North West", "North East", "South West", "South East"], "data": {"South East": {"Name": "South East"}, "North East": {"Name": "North East"}, "North West": {"Name": "North West"}, "South West": {"Name": "South West"}}, "grid": ["                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "          !!                                  ##                ", "         !!!                                 ###                ", "          !!                                  ##                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "         $$$                                  %%                ", "         $$$                                 %%%                ", "          $$                                  %%                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                ", "                                                                "]}
+
+def resolve(grid,x,y):
+    """ Resolve the attributes for a given pixel in a grid.
+    
+    js version: 
+      https://github.com/mapbox/mbtiles-spec/blob/master/1.1/utfgrid.md
+    spec:
+      https://github.com/mapbox/wax/blob/master/control/lib/gridutil.js
+    
+    """
+    utf_val = grid['grid'][x][y]
+    #http://docs.python.org/library/functions.html#ord
+    codepoint = ord(utf_val)
+    if (codepoint >= 93):
+        codepoint-=1
+    if (codepoint >= 35):
+        codepoint-=1
+    codepoint -= 32
+    key = grid['keys'][codepoint]
+    return grid['data'].get(key)
+
+
+def create_grid_map(width,height):
+    places_ds = mapnik2.PointDatasource()
+    places_ds.add_point(143.10,-38.60,'Name','South East')
+    places_ds.add_point(142.48,-38.60,'Name','South West')
+    places_ds.add_point(142.48,-38.38,'Name','North West')
+    places_ds.add_point(143.10,-38.38,'Name','North East')
+    s = mapnik2.Style()
+    r = mapnik2.Rule()
+    #symb = mapnik2.PointSymbolizer()
+    symb = mapnik2.MarkersSymbolizer()
+    symb.allow_overlap = True
+    r.symbols.append(symb)
+    label = mapnik2.TextSymbolizer(mapnik2.Expression('[Name]'),
+                'DejaVu Sans Book',
+                10,
+                mapnik2.Color('black')
+                )
+    label.allow_overlap = True
+    label.displacement = (0,-10)
+    #r.symbols.append(label)
+
+    s.rules.append(r)
+    lyr = mapnik2.Layer('Places')
+    lyr.datasource = places_ds
+    lyr.styles.append('places_labels')
+    m = mapnik2.Map(width,height)
+    m.append_style('places_labels',s)
+    m.layers.append(lyr)
+    return m
+    
+def test_render_grid():
+    """ test old method """
+    width,height = 256,256
+    m = create_grid_map(width,height)
+    ul_lonlat = mapnik2.Coord(142.30,-38.20)
+    lr_lonlat = mapnik2.Coord(143.40,-38.80)
+    m.zoom_to_box(mapnik2.Box2d(ul_lonlat,lr_lonlat))
+    grid = mapnik2.render_grid(m,0,key='Name',resolution=4,fields=['Name'])
+    eq_(grid,grid_correct)
+    eq_(resolve(grid,0,0),None)
+    
+    # check every pixel of the nw symbol
+    expected = {"Name": "North West"}
+    
+    # top row
+    eq_(resolve(grid,23,9),expected)
+    eq_(resolve(grid,23,10),expected)
+    eq_(resolve(grid,23,11),expected)
+
+    # core
+    eq_(resolve(grid,24,8),expected)
+    eq_(resolve(grid,24,9),expected)
+    eq_(resolve(grid,24,10),expected)
+    eq_(resolve(grid,24,11),expected)
+    eq_(resolve(grid,24,12),expected)
+    eq_(resolve(grid,25,8),expected)
+    eq_(resolve(grid,25,9),expected)
+    eq_(resolve(grid,25,10),expected)
+    eq_(resolve(grid,25,11),expected)
+    eq_(resolve(grid,25,12),expected)
+    
+    # bottom row
+    eq_(resolve(grid,26,9),expected)
+    eq_(resolve(grid,26,10),expected)
+    eq_(resolve(grid,26,11),expected)
+
+def test_render_grid2():
+    """ test old against new"""
+    width,height = 256,256
+    m = create_grid_map(width,height)
+    ul_lonlat = mapnik2.Coord(142.30,-38.20)
+    lr_lonlat = mapnik2.Coord(143.40,-38.80)
+    m.zoom_to_box(mapnik2.Box2d(ul_lonlat,lr_lonlat))
+
+    # new method
+    grid = mapnik2.Grid(m.width,m.height,key='Name')
+    mapnik2.render_layer(m,grid,layer=0,fields=['Name'])
+    utf1 = grid.encode('utf',resolution=4)
+    eq_(utf1,grid_correct_new)
+
+    # old method - to be removed
+    utf2 = mapnik2.render_grid(m,0,key='Name',resolution=4,fields=['Name'])
+    eq_(utf2,grid_correct)
+
+    # for complex polygons these will not be true
+    eq_(len(utf2['grid']),len(utf1['grid']))
+    eq_(len(utf2['keys']),len(utf1['keys']))
+    eq_(len(utf2['data']),len(utf1['data']))
+    
+    # check a full view is the same as a full image
+    grid_view = grid.view(0,0,width,height)
+    # for kicks check at full res too
+    utf3 = grid.encode('utf',resolution=1)
+    utf4 = grid_view.encode('utf',resolution=1)
+    eq_(utf3['grid'],utf4['grid'])
+    eq_(utf3['keys'],utf4['keys'])
+    eq_(utf3['data'],utf4['data'])
+    
+    eq_(resolve(utf4,0,0),None)
+    
+    # resolve some center points in the
+    # resampled view
+    utf5 = grid_view.encode('utf',resolution=4)
+    eq_(resolve(utf5,25,10),{"Name": "North West"})
+    eq_(resolve(utf5,25,46),{"Name": "North East"})
+    eq_(resolve(utf5,38,10),{"Name": "South West"})
+    eq_(resolve(utf5,38,46),{"Name": "South East"})
+    
+if __name__ == "__main__":
+    test_render_grid()
+    test_render_grid2()
\ No newline at end of file
--- mapnik2-2.0.0~svn2979.orig/utils/ogcserver/ogcserver.conf
+++ mapnik2-2.0.0~svn2979/utils/ogcserver/ogcserver.conf
@@ -1,4 +1,4 @@
-# $Id: ogcserver.conf 1183 2009-06-23 01:14:49Z dane $
+# $Id$
 
 # server: This section contains software related configuration parameters.
 
--- mapnik2-2.0.0~svn2979.orig/utils/ogcserver/wms.py
+++ mapnik2-2.0.0~svn2979/utils/ogcserver/wms.py
@@ -18,7 +18,7 @@
 # License along with this library; if not, write to the Free Software
 # Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA
 #
-# $Id: wms.py 1056 2009-03-31 22:23:18Z dane $
+# $Id$
 
 from mapnik.ogcserver.cgiserver import Handler
 from jon import fcgi
